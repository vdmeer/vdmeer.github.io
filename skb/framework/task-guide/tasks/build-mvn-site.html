<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7 at 2019-05-08 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20190508" />
    <meta http-equiv="Content-Language" content="en" />
    <title>SKB-FRAMEWORK &#x2013; Task: Build MVN Site</title>
    <link rel="stylesheet" href="../../css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="../../css/site.css" />
    <link rel="stylesheet" href="../../css/print.css" media="print" />

      
    <script type="text/javascript" src="../../js/apache-maven-fluido-1.5.min.js"></script>

          <link href="https://fonts.googleapis.com/css?family=Lora|Roboto+Condensed" rel="stylesheet" />
                      </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2></h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                              <li class="">
                    <a href="http://www.vandermeer.de/" class="externalLink" title="vdmeer">
        vdmeer</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="https://vdmeer.github.io/skb/" class="externalLink" title="skb">
        skb</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="../../index.html" title="framework">
        framework</a>
                    <span class="divider">/</span>
      </li>
        <li class="active ">Task: Build MVN Site</li>
        
              
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2019-05-08</li>
              <li id="projectVersion" class="pull-right">
                    Version: 0.0.3
        </li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">SKB FRAMEWORK</li>
                              
      <li>
  
                          <a href="../../index.html" title="Wellcome">
          <span class="none"></span>
        Wellcome</a>
            </li>
                                                                                                                                                                        
      <li>
  
                          <a href="../../manual.html" title="Manual">
          <span class="icon-chevron-down"></span>
        Manual</a>
                    <ul class="nav nav-list">
                    
      <li>
  
                          <a href="../../manual/options.html" title="Options">
          <span class="none"></span>
        Options</a>
            </li>
                    
      <li>
  
                          <a href="../../manual/parameters.html" title="Parameters">
          <span class="none"></span>
        Parameters</a>
            </li>
                    
      <li>
  
                          <a href="../../manual/tasks.html" title="Tasks">
          <span class="none"></span>
        Tasks</a>
            </li>
                    
      <li>
  
                          <a href="../../manual/dependencies.html" title="Dependencies">
          <span class="none"></span>
        Dependencies</a>
            </li>
                    
      <li>
  
                          <a href="../../manual/commands.html" title="Commands">
          <span class="none"></span>
        Commands</a>
            </li>
                    
      <li>
  
                          <a href="../../manual/scenarios.html" title="Scenarios">
          <span class="none"></span>
        Scenarios</a>
            </li>
                    
      <li>
  
                          <a href="../../manual/exit-status.html" title="Exit Status">
          <span class="none"></span>
        Exit Status</a>
            </li>
              </ul>
        </li>
                
      <li>
  
                          <a href="../../user-guide.html" title="User Guide">
          <span class="none"></span>
        User Guide</a>
            </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
      <li>
  
                          <a href="../../task-guide.html" title="Task Guide">
          <span class="icon-chevron-down"></span>
        Task Guide</a>
                    <ul class="nav nav-list">
                                                                                                                                                                                                                                                                                                                
      <li>
  
                          <a href="../../task-guide/use-tasks.html" title="Use Tasks">
          <span class="icon-chevron-right"></span>
        Use Tasks</a>
                  </li>
                                                                                                                    
      <li>
  
                          <a href="../../task-guide/build-tasks.html" title="Build Tasks">
          <span class="icon-chevron-down"></span>
        Build Tasks</a>
                    <ul class="nav nav-list">
                    
      <li>
  
                          <a href="../../task-guide/tasks/clean.html" title="clean">
          <span class="none"></span>
        clean</a>
            </li>
                    
      <li>
  
                          <a href="../../task-guide/tasks/build-manual.html" title="build-manual">
          <span class="none"></span>
        build-manual</a>
            </li>
                    
      <li class="active">
  
            <a href="#"><span class="none"></span>build-mvn-site</a>
          </li>
              </ul>
        </li>
                                                                                                                            
      <li>
  
                          <a href="../../task-guide/dev-tasks.html" title="Development Tasks">
          <span class="icon-chevron-right"></span>
        Development Tasks</a>
                  </li>
              </ul>
        </li>
                                                                                                                                                                                                                                                                        
      <li>
  
                          <a href="../../developer-guide.html" title="Developer Guide">
          <span class="icon-chevron-down"></span>
        Developer Guide</a>
                    <ul class="nav nav-list">
                                                                                                                                                                                                                                                          
      <li>
  
                          <a href="../../developer-guide/api.html" title="API">
          <span class="icon-chevron-right"></span>
        API</a>
                  </li>
              </ul>
        </li>
                                                                                                
      <li>
  
                          <a href="../../implementation.html" title="The Implementation">
          <span class="icon-chevron-down"></span>
        The Implementation</a>
                    <ul class="nav nav-list">
                    
      <li>
  
                          <a href="../../implementation/skb-framework.html" title="skb-framework">
          <span class="none"></span>
        skb-framework</a>
            </li>
                    
      <li>
  
                          <a href="../../implementation/loader.html" title="loader">
          <span class="none"></span>
        loader</a>
            </li>
                    
      <li>
  
                          <a href="../../implementation/shell.html" title="shell">
          <span class="none"></span>
        shell</a>
            </li>
              </ul>
        </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                                                                                                                         <a href="https://maven.apache.org/plugins/maven-site-plugin" title="maven-site" class="builtBy">
        <img class="builtBy"  alt="maven-site" src="../../images/logos/build-by-maven-black.png"    />
      </a>
                                                                                                          <a href="https://asciidoctor.org" title="asciidoctor" class="builtBy">
        <img class="builtBy"  alt="asciidoctor" src="../../images/logos/asciidoctor-transparent.png"    />
      </a>
                      </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <div class="sect1">
<h2 id="build_mvn_site">build-mvn-site</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This task can be used to build Maven sites.
Beside calling Apache Maven, it also provides functionality to run scripts before building and before staging a site.
Those scripts can take full advantage of the framework and its API.
This allows to build even very complex sites in an automated way, with features realized outside the Maven build process but fully integrated into the overall site building.</p>
</div>
<div class="paragraph">
<p>The task is not specific to one site, but can build one or more sites, even within one execution.
The parameter <em>MVN_SITES</em> is used to identify the sites that can be build.
It should contain a set of paths to the site directories.
Each of these directories should contain a <em>pom</em> file (<code>pom.xml</code>) with the Maven specifications for the site.
It also should contain a framework-specific metadata file (<code>skb-site.id</code>).
It might contain a file <code>skb-site-scripts.skb</code> with scripts to be run before the site build and before the site staging.</p>
</div>
<div class="paragraph">
<p>The general options, shown below, allow to direct the behavior of the task.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>build</em> - request one or more sites to be built</p>
</li>
<li>
<p><em>clean</em> - requests to clean one or more sites.
Clean will call <code>mvn clean</code> to do the job</p>
</li>
<li>
<p><em>list</em> - will list all defined and loaded sites, which then can be build or cleaned.</p>
</li>
<li>
<p><em>test</em> - once a site is successfully build, it can be tested.
Testing here means to start a web browser with the site&#8217;s <code>index.html</code> file.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="bash">-b | --build            builds site(s), requires a target and site ID or all
-c | --clean            cleans all site(s)
-h | --help             print help screen and exit
-l | --list             list sites
-T | --test             test sites, open in browser</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="target_options">Target Options</h3>
<div class="paragraph">
<p>The task can build a Maven site for several targets:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>targets</em> - builds all targets</p>
</li>
<li>
<p><em>ad</em> - calls Maven with the argument <code>site:attach-descriptor</code>.
This argument is important for multi-module sites with inherited descriptors</p>
</li>
<li>
<p><em>site</em> - calls Maven to build the site, but not stage it</p>
</li>
<li>
<p><em>stage</em> - calls Maven to stage a site that has been prior built successfully</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="bash">-t | --targets          mvn: all targets
     --ad               mvn: site:attach-descriptor
     --site             mvn: site
     --stage            mvn: site:stage</code></pre>
</div>
</div>
<div class="paragraph">
<p>There is no default target.</p>
</div>
</div>
<div class="sect2">
<h3 id="filter_options">Filter Options</h3>
<div class="paragraph">
<p>Filters allow to specify which of the loaded (and available) sites should be built:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>all</em> - will build all sites, in the oder they are listed (alphabetically)</p>
</li>
<li>
<p><em>id</em> - can be used to build a specific site</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="bash">-A | --all              all sites
-i | --id ID            site identifier for building</code></pre>
</div>
</div>
<div class="paragraph">
<p>There is no default filter.</p>
</div>
</div>
<div class="sect2">
<h3 id="maven_options">Maven Options</h3>
<div class="paragraph">
<p>Further options exist to configure the runtime behavior of Maven:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>profile</em> - call Maven with a specific profile setting, e.g. when the site definitions in the POM file are within a profile</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="bash">--profile PROFILE  mvn: use profile PROFILE</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples">Examples</h3>
<div class="paragraph">
<p>The framework&#8217;s own site can be build using this task.
When correctly configured, the site can be listed</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>build-mvn-site --list</p>
</div>
</div>
</div>
<div class="paragraph">
<p>This will show (with a real path instead of <em>SOME_PATH</em>)</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  Sites
   fw - SKB Framework site - SOME_PATH/dev/skb/bash/framework</pre>
</div>
</div>
<div class="paragraph">
<p>The site can then be build using</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>build-mvn-site --build --id fw</p>
</div>
</div>
</div>
<div class="paragraph">
<p>The task and Maven output will be similar to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[INFO] Scanning for projects...
[WARNING] The project de.vandermeer:skb-framework:pom:0.0.1 uses prerequisites which is only intended for maven-plugin projects but not for non maven-plugin projects. For such purposes you should use the maven-enforcer-plugin. See https://maven.apache.org/enforcer/enforcer-rules/requireMavenVersion.html
[INFO]
[INFO] --------------------&lt; de.vandermeer:skb-framework &gt;---------------------
[INFO] Building skb-framework 0.0.1
[INFO] --------------------------------[ pom ]---------------------------------
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 0.079 s
[INFO] Finished at: 2018-11-15T21:08:19Z
[INFO] ------------------------------------------------------------------------
      -&gt; building user guide (html, pdf)
      -&gt; building task guide (html, pdf)
      -&gt; building developer guide (html, pdf)
      -&gt; building implementation doc (html, pdf)</pre>
</div>
</div>
<div class="paragraph">
<p>Setting the task level to <em>info</em> will provide more information on the task&#8217;s progress.</p>
</div>
</div>
<div class="sect2">
<h3 id="site_files">Site Files</h3>
<div class="paragraph">
<p>As mentioned above, a site suitable for this task should provide a file with its metadata and might provide a file with scripts to be used in the build.
Both files must be located in the same directory as the POM file.</p>
</div>
<div class="paragraph">
<p>The metadata file must be named <code>skb-site.id</code>.
It must contain the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An identifier.
This identifier can be any string that does not contain whitespaces or <em>bash</em> special characters (such as <code>&amp;</code> or <code>*</code>).
The identifier must be unique for all site in <em>MVN_SITES</em>.</p>
</li>
<li>
<p>A description.
The description should be short, like a tag line, to fit into the listing of sites.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The source block below shows the file for the frameworks' site.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="bash"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
</pre></td>
  <td class="code"><pre>ID=fw
DESCRIPTION=&quot;the SKB Framework site&quot;</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>The file <code>skb-site-scripts.skb</code> could be provided.
If it does not exist, the task will build the site purely using Maven.
If it does exist, the task will source the file and call two functions the file must provide.
This means that the file can</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use anything a normal <em>bash</em> script can do at any place in the file</p>
</li>
<li>
<p>Use anything a normal <em>bash</em> script can do inside the two required functions</p>
</li>
<li>
<p>Use the full framework settings and API at any place in the file</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following code block shows the standard contents of the script file with the two required functions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="bash">MvnSitePreScript() {
    # any code run before Maven is called to build the site
}

MvnSitePostScript() {
    # any code run `mvn site` but before `mvn site:stage`
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To see an example have a look at the framework&#8217;s script file.
The current file can be found in the Github repository: <a href="https://raw.githubusercontent.com/vdmeer/skb-framework/master/skb-site-scripts.skb">skb-site-scripts.skb</a>.
Here, the function <code>MvnSitePreScript</code> executes framework tasks to create files for the site.
The function <code>MvnSitePostScript</code> calls tools from the AsciiDoctor tool chain to create documents.
It also uses the framework&#8217;s API function <code>MvnSiteFixAdoc</code>, which helps to fix some AsciiDoctor problem in generated HTML files in the site.</p>
</div>
</div>
<div class="sect2">
<h3 id="requirements">Requirements</h3>
<div class="paragraph">
<p>The task takes the sites it should load and build from the parameter <em>MVN_SITES</em>.
If no sites are provided, or no sites could be loaded (due to a missing side identifier file), the task will throw an error.</p>
</div>
<div class="paragraph">
<p>Building a Maven site of course requires Maven (dependency <em>maven</em>), which in turn requires a JDK to be installed on the host as well.</p>
</div>
<div class="paragraph">
<p>Testing a site is done by starting a web browser with the site&#8217;s <code>index.html</code> file.
This requires the task <code>start-browser</code> to be loaded and well-configured.
Without this task be available, sites cannot be tested.</p>
</div>
</div>
</div>
</div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                          <p>
                    Copyright &copy; 2018 Sven van der Meer. All rights reserved.
                </p>
                <p>
                    <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons Licence" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a> This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.
                </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
