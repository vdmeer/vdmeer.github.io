<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7 at 2019-05-27 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20190527" />
    <meta http-equiv="Content-Language" content="en" />
    <title>SKB-FRAMEWORK &#x2013; Implementation: skb-framework</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.5.min.js"></script>

          <link href="https://fonts.googleapis.com/css?family=Lora|Roboto+Condensed" rel="stylesheet" />
                      </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2></h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                              <li class="">
                    <a href="http://www.vandermeer.de/" class="externalLink" title="vdmeer">
        vdmeer</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="https://vdmeer.github.io/skb/" class="externalLink" title="skb">
        skb</a>
                    <span class="divider">/</span>
      </li>
            <li class="">
                    <a href="../index.html" title="framework">
        framework</a>
                    <span class="divider">/</span>
      </li>
        <li class="active ">Implementation: skb-framework</li>
        
              
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2019-05-27</li>
              <li id="projectVersion" class="pull-right">
                    Version: 0.0.4
        </li>
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">SKB FRAMEWORK</li>
                              
      <li>
  
                          <a href="../index.html" title="Welcome">
          <span class="none"></span>
        Welcome</a>
            </li>
                                                                                                                                                                        
      <li>
  
                          <a href="../manual.html" title="Manual">
          <span class="icon-chevron-down"></span>
        Manual</a>
                    <ul class="nav nav-list">
                    
      <li>
  
                          <a href="../manual/options.html" title="Options">
          <span class="none"></span>
        Options</a>
            </li>
                    
      <li>
  
                          <a href="../manual/parameters.html" title="Parameters">
          <span class="none"></span>
        Parameters</a>
            </li>
                    
      <li>
  
                          <a href="../manual/tasks.html" title="Tasks">
          <span class="none"></span>
        Tasks</a>
            </li>
                    
      <li>
  
                          <a href="../manual/dependencies.html" title="Dependencies">
          <span class="none"></span>
        Dependencies</a>
            </li>
                    
      <li>
  
                          <a href="../manual/commands.html" title="Commands">
          <span class="none"></span>
        Commands</a>
            </li>
                    
      <li>
  
                          <a href="../manual/scenarios.html" title="Scenarios">
          <span class="none"></span>
        Scenarios</a>
            </li>
                    
      <li>
  
                          <a href="../manual/exit-status.html" title="Exit Status">
          <span class="none"></span>
        Exit Status</a>
            </li>
              </ul>
        </li>
                
      <li>
  
                          <a href="../user-guide.html" title="User Guide">
          <span class="none"></span>
        User Guide</a>
            </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
      <li>
  
                          <a href="../task-guide.html" title="Task Guide">
          <span class="icon-chevron-down"></span>
        Task Guide</a>
                    <ul class="nav nav-list">
                                                                                                                                                                                                                                                                                                                
      <li>
  
                          <a href="../task-guide/use-tasks.html" title="Use Tasks">
          <span class="icon-chevron-right"></span>
        Use Tasks</a>
                  </li>
                                                                                                                            
      <li>
  
                          <a href="../task-guide/build-tasks.html" title="Build Tasks">
          <span class="icon-chevron-right"></span>
        Build Tasks</a>
                  </li>
                                                                                                                            
      <li>
  
                          <a href="../task-guide/dev-tasks.html" title="Development Tasks">
          <span class="icon-chevron-right"></span>
        Development Tasks</a>
                  </li>
              </ul>
        </li>
                                                                                                                                                                                                                                                                        
      <li>
  
                          <a href="../developer-guide.html" title="Developer Guide">
          <span class="icon-chevron-down"></span>
        Developer Guide</a>
                    <ul class="nav nav-list">
                                                                                                                                                                                                                                                          
      <li>
  
                          <a href="../developer-guide/api.html" title="API">
          <span class="icon-chevron-right"></span>
        API</a>
                  </li>
              </ul>
        </li>
                                                                                                          
      <li>
  
                          <a href="../implementation.html" title="The Implementation">
          <span class="icon-chevron-down"></span>
        The Implementation</a>
                    <ul class="nav nav-list">
                    
      <li class="active">
  
            <a href="#"><span class="none"></span>skb-framework</a>
          </li>
                    
      <li>
  
                          <a href="../implementation/loader.html" title="loader">
          <span class="none"></span>
        loader</a>
            </li>
                    
      <li>
  
                          <a href="../implementation/shell.html" title="shell">
          <span class="none"></span>
        shell</a>
            </li>
              </ul>
        </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                                                                                                                         <a href="https://maven.apache.org/plugins/maven-site-plugin" title="maven-site" class="builtBy">
        <img class="builtBy"  alt="maven-site" src="../images/logos/build-by-maven-black.png"    />
      </a>
                                                                                                          <a href="https://asciidoctor.org" title="asciidoctor" class="builtBy">
        <img class="builtBy"  alt="asciidoctor" src="../images/logos/asciidoctor-transparent.png"    />
      </a>
                      </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <div class="sect1">
<h2 id="skb_framework">skb-framework</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>skb-framework</code> is the main entry point to the framework.
It realizes two things in one.
First, it is an application itself.
Second, it is a start script that can be used by other applications to start the framework.</p>
</div>
<div class="paragraph">
<p>At the start, it checks the setting <code>__FW_LOADER_FLAVOR</code> (line 1 in the source block below).
If this variable is set, then another application wants to start the framework.
Otherwise, the <code>skb-framework</code> is the application.
In the later case, the script sets required variables for the loader (lines 3-5 below):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>__FW_LOADER_FLAVOR</code> - the flavor of the application, here <code>SF</code></p>
</li>
<li>
<p><code>__FW_LOADER_SCRIPTNAME</code> - the name of the script (application)</p>
</li>
<li>
<p><code>__FW_LOADER_APPNAME</code> - the application name</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The next step is to find the framework installation.
The script tries the variable <code>SF_HOME</code> first, <code>readlink</code> first (lines 8-13), if that fails <code>dirname</code> (lines 15-19).
If all attempts fail, the script terminates with an error (lines 20-24).
Otherwise it set <code>FW_HOME</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="bash"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td>
  <td class="code"><pre>if [[ -z ${__FW_LOADER_FLAVOR:-} ]]; then
    ## we should load the framework itself, so SF
    export __FW_LOADER_FLAVOR=&quot;SF&quot;
    export __FW_LOADER_SCRIPTNAME=&quot;$0&quot;
    export __FW_LOADER_APPNAME=&quot;SKB Framework&quot;

    ## try readline to find where we are
    if [[ -z ${SF_HOME:-} ]]; then
        SF_HOME=$(readlink -f $0)
        SF_HOME=${SF_HOME%/*}
        SF_HOME=${SF_HOME%/*}
        export SF_HOME
    fi
    ## try dirname to find where we are
    if [[ -z ${SF_HOME:-} ]]; then
        SF_HOME=$(dirname $0)
        SF_HOME=$(cd $SF_HOME/..; pwd)
        export SF_HOME
    fi
    if [[ -z ${SF_HOME:-} ]]; then
        printf &quot;  unable to set home \$SF_HOME (tried environment, readlink, and dirname \$0)\n&quot;
        printf &quot;  please set SF_HOME\n\n&quot;
        exit 10
    fi
    export FW_HOME=$SF_HOME</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>If <code>skb-framework</code> is used by another application to start the framework, the script only tries to find the framework installation.
The mechanism here is the same as explained above: try <code>FW_HOME</code> first, then <code>readlink</code>, then <code>dirname</code>.
IF all fails, exit with an error.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="bash"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td>
  <td class="code"><pre>else
    ## try readline to find where we are
    if [[ -z ${FW_HOME:-} ]]; then
        FW_HOME=$(readlink -f $0)
        FW_HOME=${FW_HOME%/*}
        FW_HOME=${FW_HOME%/*}
        export FW_HOME
    fi
    ## try dirname to find where we are
    if [[ -z ${FW_HOME:-} ]]; then
        FW_HOME=$(dirname $0)
        FW_HOME=$(cd $FW_HOME/..; pwd)
        export FW_HOME
    fi
    if [[ -z ${FW_HOME:-} ]]; then
        printf &quot;  unable to set framework home \$FW_HOME (tried environment, readlink, and dirname \$0)\n&quot;
        printf &quot;  please set FW_HOME\n\n&quot;
        exit 10
    fi</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>One the framework installation has been found, the script tests if the loader exists.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="bash"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre>if [[ ! -x $FW_HOME/bin/loader/loader.sh ]]; then
    printf &quot;  did find/set \$FW_HOME, but did not find loader\n&quot;
    printf &quot;  tried $FW_HOME/bin/loader/loader.sh\n\n&quot;
    exit 11
fi</pre></td>
</tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>When all conditions are satisfied, the script executes the loader handing over all arguments unprocessed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="bash"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
</pre></td>
  <td class="code"><pre>$FW_HOME/bin/loader/loader.sh $*
exit $?</pre></td>
</tr></table></code></pre>
</div>
</div>
</div>
</div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                          <p>
                    Copyright &copy; 2018-2019 Sven van der Meer. All rights reserved.
                </p>
                <p>
                    <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons Licence" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a> This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.
                </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
